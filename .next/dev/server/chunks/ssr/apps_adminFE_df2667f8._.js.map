{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alexander/webmizu/apps/adminFE/src/components/ui/page-header.tsx"],"sourcesContent":["import type React from \"react\"\r\nimport Link from \"next/link\"\r\nimport { ArrowLeft } from \"lucide-react\"\r\nimport { Button } from \"@/components/ui/button\"\r\n\r\ninterface PageHeaderProps {\r\n  title: string\r\n  description?: string\r\n  children?: React.ReactNode\r\n  backHref?: string\r\n}\r\n\r\nexport function PageHeader({ title, description, children, backHref }: PageHeaderProps) {\r\n  return (\r\n    <div className=\"mb-6 md:mb-8 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\">\r\n      <div className=\"flex items-center gap-3\">\r\n        {backHref && (\r\n          <Link href={backHref}>\r\n            <Button variant=\"ghost\" size=\"icon\" className=\"text-[#0A2540] hover:bg-[#F6F9FC] shrink-0\">\r\n              <ArrowLeft className=\"h-5 w-5\" />\r\n            </Button>\r\n          </Link>\r\n        )}\r\n        <div>\r\n          <h1 className=\"font-heading text-xl md:text-2xl font-bold text-[#0A2540]\">{title}</h1>\r\n          {description && <p className=\"mt-1 text-xs md:text-sm text-muted-foreground\">{description}</p>}\r\n        </div>\r\n      </div>\r\n      {children && <div className=\"flex items-center gap-2 md:gap-3\">{children}</div>}\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;;;AASO,SAAS,WAAW,EAAE,KAAK,EAAE,WAAW,EAAE,QAAQ,EAAE,QAAQ,EAAmB;IACpF,qBACE,iQAAC;QAAI,WAAU;;0BACb,iQAAC;gBAAI,WAAU;;oBACZ,0BACC,iQAAC,0LAAI;wBAAC,MAAM;kCACV,cAAA,iQAAC,wJAAM;4BAAC,SAAQ;4BAAQ,MAAK;4BAAO,WAAU;sCAC5C,cAAA,iQAAC,gPAAS;gCAAC,WAAU;;;;;;;;;;;;;;;;kCAI3B,iQAAC;;0CACC,iQAAC;gCAAG,WAAU;0CAA6D;;;;;;4BAC1E,6BAAe,iQAAC;gCAAE,WAAU;0CAAiD;;;;;;;;;;;;;;;;;;YAGjF,0BAAY,iQAAC;gBAAI,WAAU;0BAAoC;;;;;;;;;;;;AAGtE"}},
    {"offset": {"line": 95, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alexander/webmizu/apps/adminFE/components/ui/spinner.tsx"],"sourcesContent":["import { Loader2 } from \"lucide-react\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface SpinnerProps extends React.HTMLAttributes<SVGElement> {}\r\n\r\nexport function Spinner({ className, ...props }: SpinnerProps) {\r\n  return (\r\n    <Loader2 className={cn(\"h-4 w-4 animate-spin\", className)} {...props} />\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAIO,SAAS,QAAQ,EAAE,SAAS,EAAE,GAAG,OAAqB;IAC3D,qBACE,iQAAC,+OAAO;QAAC,WAAW,IAAA,qIAAE,EAAC,wBAAwB;QAAa,GAAG,KAAK;;;;;;AAExE"}},
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alexander/webmizu/apps/adminFE/components/ui/loading-button.tsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { Button, ButtonProps } from \"@/components/ui/button\"\r\nimport { Spinner } from \"@/components/ui/spinner\"\r\n\r\ninterface LoadingButtonProps extends ButtonProps {\r\n  isLoading?: boolean\r\n  loadingText?: string\r\n}\r\n\r\nexport function LoadingButton({ \r\n  children, \r\n  isLoading, \r\n  loadingText,\r\n  disabled, \r\n  ...props \r\n}: LoadingButtonProps) {\r\n  return (\r\n    <Button disabled={disabled || isLoading} {...props}>\r\n      {isLoading ? (\r\n        <>\r\n          <Spinner className=\"mr-2\" />\r\n          {loadingText || children}\r\n        </>\r\n      ) : (\r\n        children\r\n      )}\r\n    </Button>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAOO,SAAS,cAAc,EAC5B,QAAQ,EACR,SAAS,EACT,WAAW,EACX,QAAQ,EACR,GAAG,OACgB;IACnB,qBACE,iQAAC,wJAAM;QAAC,UAAU,YAAY;QAAY,GAAG,KAAK;kBAC/C,0BACC;;8BACE,iQAAC,0JAAO;oBAAC,WAAU;;;;;;gBAClB,eAAe;;2BAGlB;;;;;;AAIR"}},
    {"offset": {"line": 155, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alexander/webmizu/apps/adminFE/components/ui/input.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\r\n  return (\r\n    <input\r\n      type={type}\r\n      data-slot=\"input\"\r\n      className={cn(\r\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\r\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\r\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Input }\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,iQAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,qIAAE,EACX,8bACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 180, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alexander/webmizu/apps/adminFE/components/ui/textarea.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Textarea({ className, ...props }: React.ComponentProps<'textarea'>) {\r\n  return (\r\n    <textarea\r\n      data-slot=\"textarea\"\r\n      className={cn(\r\n        'border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Textarea }\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAyC;IACzE,qBACE,iQAAC;QACC,aAAU;QACV,WAAW,IAAA,qIAAE,EACX,ucACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 204, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alexander/webmizu/apps/adminFE/components/ui/label.tsx"],"sourcesContent":["'use client'\r\n\r\nimport * as React from 'react'\r\nimport * as LabelPrimitive from '@radix-ui/react-label'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Label({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\r\n  return (\r\n    <LabelPrimitive.Root\r\n      data-slot=\"label\"\r\n      className={cn(\r\n        'flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Label }\r\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,iQAAC,4LAAmB;QAClB,aAAU;QACV,WAAW,IAAA,qIAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 231, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alexander/webmizu/apps/adminFE/components/ui/form.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport type * as LabelPrimitive from \"@radix-ui/react-label\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { Controller, type ControllerProps, type FieldPath, type FieldValues, FormProvider, useFormContext } from \"react-hook-form\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\nimport { Label } from \"@/components/ui/label\"\r\n\r\nconst Form = FormProvider\r\n\r\ntype FormFieldContextValue<\r\n  TFieldValues extends FieldValues = FieldValues,\r\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,\r\n> = {\r\n  name: TName\r\n}\r\n\r\nconst FormFieldContext = React.createContext<FormFieldContextValue>({} as FormFieldContextValue)\r\n\r\nconst FormField = <\r\n  TFieldValues extends FieldValues = FieldValues,\r\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,\r\n>({\r\n  ...props\r\n}: ControllerProps<TFieldValues, TName>) => {\r\n  return (\r\n    <FormFieldContext.Provider value={{ name: props.name }}>\r\n      <Controller {...props} />\r\n    </FormFieldContext.Provider>\r\n  )\r\n}\r\n\r\nconst useFormField = () => {\r\n  const fieldContext = React.useContext(FormFieldContext)\r\n  const itemContext = React.useContext(FormItemContext)\r\n  const { getFieldState, formState } = useFormContext()\r\n\r\n  const fieldState = getFieldState(fieldContext.name, formState)\r\n\r\n  if (!fieldContext) {\r\n    throw new Error(\"useFormField must be used within <FormField>\")\r\n  }\r\n\r\n  const { id } = itemContext\r\n\r\n  return {\r\n    id,\r\n    name: fieldContext.name,\r\n    formItemId: `${id}-form-item`,\r\n    formDescriptionId: `${id}-form-item-description`,\r\n    formMessageId: `${id}-form-item-message`,\r\n    ...fieldState,\r\n  }\r\n}\r\n\r\ntype FormItemContextValue = {\r\n  id: string\r\n}\r\n\r\nconst FormItemContext = React.createContext<FormItemContextValue>({} as FormItemContextValue)\r\n\r\nconst FormItem = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\r\n  ({ className, ...props }, ref) => {\r\n    const id = React.useId()\r\n\r\n    return (\r\n      <FormItemContext.Provider value={{ id }}>\r\n        <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\r\n      </FormItemContext.Provider>\r\n    )\r\n  },\r\n)\r\nFormItem.displayName = \"FormItem\"\r\n\r\nconst FormLabel = React.forwardRef<\r\n  React.ElementRef<typeof LabelPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\r\n>(({ className, ...props }, ref) => {\r\n  const { error, formItemId } = useFormField()\r\n\r\n  return (\r\n    <Label\r\n      ref={ref}\r\n      className={cn(error && \"text-destructive\", className)}\r\n      htmlFor={formItemId}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nFormLabel.displayName = \"FormLabel\"\r\n\r\nconst FormControl = React.forwardRef<\r\n  React.ElementRef<typeof Slot>,\r\n  React.ComponentPropsWithoutRef<typeof Slot>\r\n>(({ ...props }, ref) => {\r\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\r\n\r\n  return (\r\n    <Slot\r\n      ref={ref}\r\n      id={formItemId}\r\n      aria-describedby={!error ? `${formDescriptionId}` : `${formDescriptionId} ${formMessageId}`}\r\n      aria-invalid={!!error}\r\n      {...props}\r\n    />\r\n  )\r\n})\r\nFormControl.displayName = \"FormControl\"\r\n\r\nconst FormDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(\r\n  ({ className, ...props }, ref) => {\r\n    const { formDescriptionId } = useFormField()\r\n\r\n    return (\r\n      <p\r\n        ref={ref}\r\n        id={formDescriptionId}\r\n        className={cn(\"text-sm text-muted-foreground\", className)}\r\n        {...props}\r\n      />\r\n    )\r\n  },\r\n)\r\nFormDescription.displayName = \"FormDescription\"\r\n\r\nconst FormMessage = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(\r\n  ({ className, children, ...props }, ref) => {\r\n    const { error, formMessageId } = useFormField()\r\n    const body = error ? String(error?.message) : children\r\n\r\n    if (!body) {\r\n      return null\r\n    }\r\n\r\n    return (\r\n      <p\r\n        ref={ref}\r\n        id={formMessageId}\r\n        className={cn(\"text-sm font-medium text-destructive\", className)}\r\n        {...props}\r\n      />\r\n    )\r\n  },\r\n)\r\nFormMessage.displayName = \"FormMessage\"\r\n\r\nexport { useFormField, Form, FormItem, FormLabel, FormControl, FormDescription, FormMessage, FormField }\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAEA;AAEA;AACA;AAEA;AACA;AARA;;;;;;;AAUA,MAAM,OAAO,iMAAY;AASzB,MAAM,iCAAmB,yOAAmB,CAAwB,CAAC;AAErE,MAAM,YAAY,CAGhB,EACA,GAAG,OACkC;IACrC,qBACE,iQAAC,iBAAiB,QAAQ;QAAC,OAAO;YAAE,MAAM,MAAM,IAAI;QAAC;kBACnD,cAAA,iQAAC,+LAAU;YAAE,GAAG,KAAK;;;;;;;;;;;AAG3B;AAEA,MAAM,eAAe;IACnB,MAAM,eAAe,sOAAgB,CAAC;IACtC,MAAM,cAAc,sOAAgB,CAAC;IACrC,MAAM,EAAE,aAAa,EAAE,SAAS,EAAE,GAAG,IAAA,mMAAc;IAEnD,MAAM,aAAa,cAAc,aAAa,IAAI,EAAE;IAEpD,IAAI,CAAC,cAAc;QACjB,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,EAAE,EAAE,EAAE,GAAG;IAEf,OAAO;QACL;QACA,MAAM,aAAa,IAAI;QACvB,YAAY,GAAG,GAAG,UAAU,CAAC;QAC7B,mBAAmB,GAAG,GAAG,sBAAsB,CAAC;QAChD,eAAe,GAAG,GAAG,kBAAkB,CAAC;QACxC,GAAG,UAAU;IACf;AACF;AAMA,MAAM,gCAAkB,yOAAmB,CAAuB,CAAC;AAEnE,MAAM,yBAAW,sOAAgB,CAC/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IACxB,MAAM,KAAK,iOAAW;IAEtB,qBACE,iQAAC,gBAAgB,QAAQ;QAAC,OAAO;YAAE;QAAG;kBACpC,cAAA,iQAAC;YAAI,KAAK;YAAK,WAAW,IAAA,qIAAE,EAAC,aAAa;YAAa,GAAG,KAAK;;;;;;;;;;;AAGrE;AAEF,SAAS,WAAW,GAAG;AAEvB,MAAM,0BAAY,sOAAgB,CAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IAC1B,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE,GAAG;IAE9B,qBACE,iQAAC,sJAAK;QACJ,KAAK;QACL,WAAW,IAAA,qIAAE,EAAC,SAAS,oBAAoB;QAC3C,SAAS;QACR,GAAG,KAAK;;;;;;AAGf;AACA,UAAU,WAAW,GAAG;AAExB,MAAM,4BAAc,sOAAgB,CAGlC,CAAC,EAAE,GAAG,OAAO,EAAE;IACf,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE,iBAAiB,EAAE,aAAa,EAAE,GAAG;IAEhE,qBACE,iQAAC,2LAAI;QACH,KAAK;QACL,IAAI;QACJ,oBAAkB,CAAC,QAAQ,GAAG,mBAAmB,GAAG,GAAG,kBAAkB,CAAC,EAAE,eAAe;QAC3F,gBAAc,CAAC,CAAC;QACf,GAAG,KAAK;;;;;;AAGf;AACA,YAAY,WAAW,GAAG;AAE1B,MAAM,gCAAkB,sOAAgB,CACtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IACxB,MAAM,EAAE,iBAAiB,EAAE,GAAG;IAE9B,qBACE,iQAAC;QACC,KAAK;QACL,IAAI;QACJ,WAAW,IAAA,qIAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEF,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,sOAAgB,CAClC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;IAClC,MAAM,EAAE,KAAK,EAAE,aAAa,EAAE,GAAG;IACjC,MAAM,OAAO,QAAQ,OAAO,OAAO,WAAW;IAE9C,IAAI,CAAC,MAAM;QACT,OAAO;IACT;IAEA,qBACE,iQAAC;QACC,KAAK;QACL,IAAI;QACJ,WAAW,IAAA,qIAAE,EAAC,wCAAwC;QACrD,GAAG,KAAK;;;;;;AAGf;AAEF,YAAY,WAAW,GAAG"}},
    {"offset": {"line": 389, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alexander/webmizu/apps/adminFE/src/features/technicians/components/technician-form.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { useRouter } from \"next/navigation\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { zodResolver } from \"@hookform/resolvers/zod\"\r\nimport * as z from \"zod\"\r\nimport { Loader2, Upload, X } from \"lucide-react\"\r\nimport { toast } from \"sonner\"\r\n\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { LoadingButton } from \"@/components/ui/loading-button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Textarea } from \"@/components/ui/textarea\"\r\nimport {\r\n  Form,\r\n  FormControl,\r\n  FormField,\r\n  FormItem,\r\n  FormLabel,\r\n  FormMessage,\r\n} from \"@/components/ui/form\"\r\nimport { useSupabase } from \"@/src/components/providers/supabase-provider\"\r\nimport { createApiClient } from \"@/src/lib/api/client\"\r\nimport { Technician } from \"@/src/types\"\r\n\r\nconst technicianSchema = z.object({\r\n  name: z.string().min(2, \"Name must be at least 2 characters\"),\r\n  phone: z.string().optional(),\r\n  notes: z.string().optional(),\r\n})\r\n\r\ntype TechnicianFormValues = z.infer<typeof technicianSchema>\r\n\r\ninterface TechnicianFormProps {\r\n  initialData?: Technician\r\n}\r\n\r\nexport function TechnicianForm({ initialData }: TechnicianFormProps) {\r\n  const router = useRouter()\r\n  const { supabase, session } = useSupabase()\r\n  const [isLoading, setIsLoading] = useState(false)\r\n  const [imageFile, setImageFile] = useState<File | null>(null)\r\n  const [imagePreview, setImagePreview] = useState<string | null>(initialData?.photo_url || null)\r\n  const isEditing = !!initialData\r\n\r\n  const form = useForm<TechnicianFormValues>({\r\n    resolver: zodResolver(technicianSchema),\r\n    defaultValues: {\r\n      name: initialData?.name || \"\",\r\n      phone: initialData?.phone || \"\",\r\n      notes: initialData?.notes || \"\",\r\n    },\r\n  })\r\n\r\n  // Reset form when initialData loads (if async)\r\n  useEffect(() => {\r\n    if (initialData) {\r\n      form.reset({\r\n        name: initialData.name,\r\n        phone: initialData.phone || \"\",\r\n        notes: initialData.notes || \"\",\r\n      })\r\n      setImagePreview(initialData.photo_url || null)\r\n    }\r\n  }, [initialData, form])\r\n\r\n  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0]\r\n    if (file) {\r\n      if (file.size > 5 * 1024 * 1024) {\r\n        toast.error(\"Image too large\", { description: \"Max file size is 5MB\" })\r\n        return\r\n      }\r\n      setImageFile(file)\r\n      const reader = new FileReader()\r\n      reader.onloadend = () => {\r\n        setImagePreview(reader.result as string)\r\n      }\r\n      reader.readAsDataURL(file)\r\n    }\r\n  }\r\n\r\n  const removeImage = () => {\r\n    setImageFile(null)\r\n    setImagePreview(null)\r\n  }\r\n\r\n  const uploadImage = async (file: File, name: string): Promise<string | null> => {\r\n    try {\r\n      const sanitizedName = name.replace(/[^a-z0-9]/gi, '-').toLowerCase()\r\n      const timestamp = Date.now()\r\n      const filePath = `${sanitizedName}-${timestamp}`\r\n      \r\n      const { data, error } = await supabase.storage\r\n        .from(\"technicians\") // Bucket name: technicians\r\n        .upload(filePath, file)\r\n\r\n      if (error) throw error\r\n\r\n      const { data: publicUrlData } = supabase.storage\r\n        .from(\"technicians\")\r\n        .getPublicUrl(filePath)\r\n\r\n      return publicUrlData.publicUrl\r\n    } catch (error: any) {\r\n      console.error(\"Storage upload error:\", error)\r\n      toast.error(\"Failed to upload image\", { description: error.message })\r\n      return null\r\n    }\r\n  }\r\n\r\n  async function onSubmit(data: TechnicianFormValues) {\r\n    if (!session) return\r\n    setIsLoading(true)\r\n\r\n    try {\r\n      let photoUrl: string | undefined = initialData?.photo_url || undefined\r\n\r\n      if (imageFile) {\r\n        const url = await uploadImage(imageFile, data.name)\r\n        if (url) photoUrl = url\r\n        else {\r\n           setIsLoading(false)\r\n           return\r\n        }\r\n      } else if (imagePreview === null && initialData?.photo_url) {\r\n        // Handle image removal if logic supports it (not strictly required by prompt but good UX)\r\n        // For now we assume if imagePreview is null, user wants to remove it?\r\n        // But we didn't implement explicit 'delete' logic in backend DTO yet, \r\n        // passing null might work if backend allows it.\r\n        // Let's assume keep existing if not changed, unless explicitly cleared?\r\n        // Simplicity: If imageFile is set, update. If cleared, strictly speaking we should clear in DB.\r\n        // Current logic: removeImage sets preview to null.\r\n        if (imagePreview === null) photoUrl = \"\" \r\n      }\r\n\r\n      const api = createApiClient(session)\r\n      \r\n      if (isEditing && initialData) {\r\n        await api.technicians.update(initialData.id, {\r\n          ...data,\r\n          photo_url: photoUrl\r\n        })\r\n        toast.success(\"Technician updated\")\r\n      } else {\r\n        await api.technicians.create({\r\n          ...data,\r\n          photo_url: photoUrl,\r\n        })\r\n        toast.success(\"Technician created\")\r\n      }\r\n\r\n      router.push(\"/admin/technicians\")\r\n      router.refresh()\r\n    } catch (error: any) {\r\n      console.error(error)\r\n      toast.error(`Failed to ${isEditing ? 'update' : 'create'} technician`, { description: error.message })\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-2xl mx-auto\">\r\n      <Form {...form}>\r\n        <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-8\">\r\n          \r\n          {/* Image Upload Section */}\r\n          <div className=\"space-y-4\">\r\n            <FormLabel>Profile Photo</FormLabel>\r\n            <div className=\"flex items-center gap-6\">\r\n              <div className=\"relative h-32 w-32 rounded-full border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden bg-gray-50\">\r\n                {imagePreview ? (\r\n                  <>\r\n                    <img src={imagePreview} alt=\"Preview\" className=\"h-full w-full object-cover\" />\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={removeImage}\r\n                      className=\"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity\"\r\n                    >\r\n                      <X className=\"h-8 w-8 text-white\" />\r\n                    </button>\r\n                  </>\r\n                ) : (\r\n                  <Upload className=\"h-8 w-8 text-gray-400\" />\r\n                )}\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Input\r\n                  type=\"file\"\r\n                  accept=\"image/*\"\r\n                  onChange={handleImageChange}\r\n                  className=\"max-w-xs\"\r\n                />\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  Recommended: Square image, max 5MB.\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"grid gap-6 md:grid-cols-2\">\r\n            <FormField\r\n              control={form.control}\r\n              name=\"name\"\r\n              render={({ field }) => (\r\n                <FormItem>\r\n                  <FormLabel>Full Name</FormLabel>\r\n                  <FormControl>\r\n                    <Input placeholder=\"e.g. John Doe\" {...field} />\r\n                  </FormControl>\r\n                  <FormMessage />\r\n                </FormItem>\r\n              )}\r\n            />\r\n\r\n            <FormField\r\n              control={form.control}\r\n              name=\"phone\"\r\n              render={({ field }) => (\r\n                <FormItem>\r\n                  <FormLabel>Phone Number</FormLabel>\r\n                  <FormControl>\r\n                    <Input placeholder=\"e.g. +1 555 000 0000\" {...field} />\r\n                  </FormControl>\r\n                  <FormMessage />\r\n                </FormItem>\r\n              )}\r\n            />\r\n          </div>\r\n\r\n          <FormField\r\n            control={form.control}\r\n            name=\"notes\"\r\n            render={({ field }) => (\r\n              <FormItem>\r\n                <FormLabel>Notes (Optional)</FormLabel>\r\n                <FormControl>\r\n                  <Textarea\r\n                    placeholder=\"Certifications, skills, or other details...\"\r\n                    className=\"min-h-[100px]\"\r\n                    {...field}\r\n                  />\r\n                </FormControl>\r\n                <FormMessage />\r\n              </FormItem>\r\n            )}\r\n          />\r\n\r\n          <div className=\"flex justify-end gap-4\">\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              onClick={() => router.back()}\r\n              disabled={isLoading}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <LoadingButton \r\n              type=\"submit\" \r\n              isLoading={isLoading} \r\n              loadingText={isEditing ? \"Updating...\" : \"Creating...\"}\r\n              className=\"bg-[#00C49A] hover:bg-[#00A07D] text-white\"\r\n            >\r\n              {isEditing ? \"Update Technician\" : \"Create Technician\"}\r\n            </LoadingButton>\r\n          </div>\r\n        </form>\r\n      </Form>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 835, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alexander/webmizu/apps/adminFE/app/admin/technicians/%5Bid%5D/edit/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useState } from \"react\"\r\nimport { useParams } from \"next/navigation\"\r\nimport { PageHeader } from \"@/src/components/ui/page-header\"\r\nimport { TechnicianForm } from \"@/src/features/technicians/components/technician-form\"\r\nimport { useSupabase } from \"@/src/components/providers/supabase-provider\"\r\nimport { createApiClient } from \"@/src/lib/api/client\"\r\nimport { Technician } from \"@/src/types\"\r\n\r\nexport default function EditTechnicianPage() {\r\n  const params = useParams()\r\n  const id = params?.id as string\r\n  const { session } = useSupabase()\r\n  const [technician, setTechnician] = useState<Technician | undefined>(undefined)\r\n  const [loading, setLoading] = useState(true)\r\n\r\n  useEffect(() => {\r\n    const fetchTechnician = async () => {\r\n      if (!session || !id) return\r\n      try {\r\n        const api = createApiClient(session)\r\n        const res: any = await api.technicians.list({ limit: 1, q: \"\" }) \r\n        // Optimization: Ideally we have getById in API client client.ts\r\n        // But checking client.ts, we only implemented list, create, update?\r\n        // Let's quickly check client.ts or just implement getOne there.\r\n        // Wait, I only saw list, create in client.ts edit previously.\r\n        // I need to add getOne to client.ts if it's missing.\r\n        // For now, let's assume I will fix client.ts, or just use list filtered by ID if API supports it?\r\n        // Actually, let's just fetch list and find? No, that's bad.\r\n        // I will add getById to client.ts in next step.\r\n        // For now, I'll put a placeholder call.\r\n        const detailRes: any = await api.technicians.getOne(id)\r\n        if (detailRes.success) {\r\n           setTechnician(detailRes.data)\r\n        }\r\n      } catch (err) {\r\n        console.error(err)\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n    fetchTechnician()\r\n  }, [session, id])\r\n\r\n  if (loading) return <div>Loading...</div>\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <PageHeader\r\n        title=\"Edit Technician\"\r\n        description=\"Update technician details.\"\r\n      />\r\n      <div className=\"bg-white rounded-lg shadow-sm border p-6\">\r\n        {technician && <TechnicianForm initialData={technician} />}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAPA;;;;;;;;AAUe,SAAS;IACtB,MAAM,SAAS,IAAA,kKAAS;IACxB,MAAM,KAAK,QAAQ;IACnB,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,yLAAW;IAC/B,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,oOAAQ,EAAyB;IACrE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,oOAAQ,EAAC;IAEvC,IAAA,qOAAS,EAAC;QACR,MAAM,kBAAkB;YACtB,IAAI,CAAC,WAAW,CAAC,IAAI;YACrB,IAAI;gBACF,MAAM,MAAM,IAAA,iKAAe,EAAC;gBAC5B,MAAM,MAAW,MAAM,IAAI,WAAW,CAAC,IAAI,CAAC;oBAAE,OAAO;oBAAG,GAAG;gBAAG;gBAC9D,gEAAgE;gBAChE,oEAAoE;gBACpE,gEAAgE;gBAChE,8DAA8D;gBAC9D,qDAAqD;gBACrD,kGAAkG;gBAClG,4DAA4D;gBAC5D,gDAAgD;gBAChD,wCAAwC;gBACxC,MAAM,YAAiB,MAAM,IAAI,WAAW,CAAC,MAAM,CAAC;gBACpD,IAAI,UAAU,OAAO,EAAE;oBACpB,cAAc,UAAU,IAAI;gBAC/B;YACF,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC;YAChB,SAAU;gBACR,WAAW;YACb;QACF;QACA;IACF,GAAG;QAAC;QAAS;KAAG;IAEhB,IAAI,SAAS,qBAAO,iQAAC;kBAAI;;;;;;IAEzB,qBACE,iQAAC;QAAI,WAAU;;0BACb,iQAAC,2KAAU;gBACT,OAAM;gBACN,aAAY;;;;;;0BAEd,iQAAC;gBAAI,WAAU;0BACZ,4BAAc,iQAAC,wMAAc;oBAAC,aAAa;;;;;;;;;;;;;;;;;AAIpD"}}]
}