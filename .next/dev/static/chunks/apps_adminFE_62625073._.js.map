{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alexander/webmizu/apps/adminFE/components/ui/input.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\r\n  return (\r\n    <input\r\n      type={type}\r\n      data-slot=\"input\"\r\n      className={cn(\r\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\r\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\r\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Input }\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,gNAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,wIAAE,EACX,8bACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS"}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alexander/webmizu/apps/adminFE/components/ui/textarea.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Textarea({ className, ...props }: React.ComponentProps<'textarea'>) {\r\n  return (\r\n    <textarea\r\n      data-slot=\"textarea\"\r\n      className={cn(\r\n        'border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Textarea }\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAyC;IACzE,qBACE,gNAAC;QACC,aAAU;QACV,WAAW,IAAA,wIAAE,EACX,ucACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS"}},
    {"offset": {"line": 65, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Alexander/webmizu/apps/adminFE/src/features/technicians/components/add-technician-form.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState } from \"react\"\r\nimport { useRouter } from \"next/navigation\"\r\nimport { useForm } from \"react-hook-form\"\r\nimport { zodResolver } from \"@hookform/resolvers/zod\"\r\nimport * as z from \"zod\"\r\nimport { Loader2, Upload, X } from \"lucide-react\"\r\nimport { toast } from \"sonner\"\r\n\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Textarea } from \"@/components/ui/textarea\"\r\nimport {\r\n  Form,\r\n  FormControl,\r\n  FormField,\r\n  FormItem,\r\n  FormLabel,\r\n  FormMessage,\r\n} from \"@/components/ui/form\"\r\nimport { useSupabase } from \"@/src/components/providers/supabase-provider\"\r\nimport { createApiClient } from \"@/src/lib/api/client\"\r\n\r\nconst technicianSchema = z.object({\r\n  name: z.string().min(2, \"Name must be at least 2 characters\"),\r\n  phone: z.string().optional(),\r\n  notes: z.string().optional(),\r\n})\r\n\r\ntype TechnicianFormValues = z.infer<typeof technicianSchema>\r\n\r\nexport function AddTechnicianForm() {\r\n  const router = useRouter()\r\n  const { supabase, session } = useSupabase()\r\n  const [isLoading, setIsLoading] = useState(false)\r\n  const [imageFile, setImageFile] = useState<File | null>(null)\r\n  const [imagePreview, setImagePreview] = useState<string | null>(null)\r\n\r\n  const form = useForm<TechnicianFormValues>({\r\n    resolver: zodResolver(technicianSchema),\r\n    defaultValues: {\r\n      name: \"\",\r\n      phone: \"\",\r\n      notes: \"\",\r\n    },\r\n  })\r\n\r\n  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0]\r\n    if (file) {\r\n      if (file.size > 5 * 1024 * 1024) {\r\n        toast.error(\"Image too large\", { description: \"Max file size is 5MB\" })\r\n        return\r\n      }\r\n      setImageFile(file)\r\n      const reader = new FileReader()\r\n      reader.onloadend = () => {\r\n        setImagePreview(reader.result as string)\r\n      }\r\n      reader.readAsDataURL(file)\r\n    }\r\n  }\r\n\r\n  const removeImage = () => {\r\n    setImageFile(null)\r\n    setImagePreview(null)\r\n  }\r\n\r\n  const uploadImage = async (file: File, name: string): Promise<string | null> => {\r\n    try {\r\n      // User suggestion: technician name - created at (timestamp)\r\n      // Sanitize name for filename\r\n      const sanitizedName = name.replace(/[^a-z0-9]/gi, '-').toLowerCase()\r\n      const timestamp = Date.now()\r\n      const filePath = `${sanitizedName}-${timestamp}`\r\n      \r\n      const { data, error } = await supabase.storage\r\n        .from(\"technician-photos\") // Bucket name\r\n        .upload(filePath, file)\r\n\r\n      if (error) throw error\r\n\r\n      const { data: publicUrlData } = supabase.storage\r\n        .from(\"technician-photos\")\r\n        .getPublicUrl(filePath)\r\n\r\n      return publicUrlData.publicUrl\r\n    } catch (error: any) {\r\n      console.error(\"Storage upload error:\", error)\r\n      toast.error(\"Failed to upload image\", { description: error.message })\r\n      return null\r\n    }\r\n  }\r\n\r\n  async function onSubmit(data: TechnicianFormValues) {\r\n    if (!session) return\r\n    setIsLoading(true)\r\n\r\n    try {\r\n      let photoUrl = undefined\r\n\r\n      if (imageFile) {\r\n        const url = await uploadImage(imageFile, data.name)\r\n        if (url) photoUrl = url\r\n        else {\r\n           // If upload failed, stop submission? Or continue without photo?\r\n           // Let's stop and let user decide/retry\r\n           setIsLoading(false)\r\n           return\r\n        }\r\n      }\r\n\r\n      const api = createApiClient(session)\r\n      await api.technicians.create({\r\n        ...data,\r\n        photo_url: photoUrl,\r\n      })\r\n\r\n      toast.success(\"Technician created successfully\")\r\n      router.push(\"/admin/technicians\")\r\n      router.refresh()\r\n    } catch (error: any) {\r\n      console.error(error)\r\n      toast.error(\"Failed to create technician\", { description: error.message })\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-2xl mx-auto\">\r\n      <Form {...form}>\r\n        <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-8\">\r\n          \r\n          {/* Image Upload Section */}\r\n          <div className=\"space-y-4\">\r\n            <FormLabel>Profile Photo</FormLabel>\r\n            <div className=\"flex items-center gap-6\">\r\n              <div className=\"relative h-32 w-32 rounded-full border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden bg-gray-50\">\r\n                {imagePreview ? (\r\n                  <>\r\n                    <img src={imagePreview} alt=\"Preview\" className=\"h-full w-full object-cover\" />\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={removeImage}\r\n                      className=\"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity\"\r\n                    >\r\n                      <X className=\"h-8 w-8 text-white\" />\r\n                    </button>\r\n                  </>\r\n                ) : (\r\n                  <Upload className=\"h-8 w-8 text-gray-400\" />\r\n                )}\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Input\r\n                  type=\"file\"\r\n                  accept=\"image/*\"\r\n                  onChange={handleImageChange}\r\n                  className=\"max-w-xs\"\r\n                />\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  Recommended: Square image, max 5MB.\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"grid gap-6 md:grid-cols-2\">\r\n            <FormField\r\n              control={form.control}\r\n              name=\"name\"\r\n              render={({ field }) => (\r\n                <FormItem>\r\n                  <FormLabel>Full Name</FormLabel>\r\n                  <FormControl>\r\n                    <Input placeholder=\"e.g. John Doe\" {...field} />\r\n                  </FormControl>\r\n                  <FormMessage />\r\n                </FormItem>\r\n              )}\r\n            />\r\n\r\n            <FormField\r\n              control={form.control}\r\n              name=\"phone\"\r\n              render={({ field }) => (\r\n                <FormItem>\r\n                  <FormLabel>Phone Number</FormLabel>\r\n                  <FormControl>\r\n                    <Input placeholder=\"e.g. +1 555 000 0000\" {...field} />\r\n                  </FormControl>\r\n                  <FormMessage />\r\n                </FormItem>\r\n              )}\r\n            />\r\n          </div>\r\n\r\n          <FormField\r\n            control={form.control}\r\n            name=\"notes\"\r\n            render={({ field }) => (\r\n              <FormItem>\r\n                <FormLabel>Notes (Optional)</FormLabel>\r\n                <FormControl>\r\n                  <Textarea\r\n                    placeholder=\"Certifications, skills, or other details...\"\r\n                    className=\"min-h-[100px]\"\r\n                    {...field}\r\n                  />\r\n                </FormControl>\r\n                <FormMessage />\r\n              </FormItem>\r\n            )}\r\n          />\r\n\r\n          <div className=\"flex justify-end gap-4\">\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              onClick={() => router.back()}\r\n              disabled={isLoading}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button type=\"submit\" disabled={isLoading} className=\"bg-[#00C49A] hover:bg-[#00A07D] text-white\">\r\n              {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n              Create Technician\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      </Form>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}